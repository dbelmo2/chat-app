(this["webpackJsonpthe-lounge"]=this["webpackJsonpthe-lounge"]||[]).push([[0],{116:function(e,t){},118:function(e,t){},127:function(e,t,n){},128:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n.n(a),s=n(78),i=n.n(s),l=n(9),r=n(29),o=n(52),u=(n(87),n(10)),j=n(13),d=n(24),b=n.n(d),p=n(33),m=(n(89),n(42));m.a.initializeApp({apiKey:"AIzaSyB_t8D_XE6j1jafZXKVR3dDM97A284QJrs",authDomain:"chatty--app.firebaseapp.com",projectId:"chatty--app",storageBucket:"chatty--app.appspot.com",messagingSenderId:"617837362774",appId:"1:617837362774:web:23fa55d65f5c52505345f7",measurementId:"G-96T16EQFWW"});var h=m.a.auth,O=m.a.database();function f(e,t){return h().createUserWithEmailAndPassword(e,t)}function x(e,t){return h().signInWithEmailAndPassword(e,t)}function g(){var e=new h.GoogleAuthProvider;return h().signInWithPopup(e)}function v(){var e=new h.GithubAuthProvider;return h().signInWithPopup(e)}function N(){return h().signOut()}var C=n(2);var y=function(e){var t=e.isSignUp,n=Object(a.useState)(!1),c=Object(l.a)(n,2),s=c[0],i=c[1],r=Object(a.useState)(""),o=Object(l.a)(r,2),u=o[0],d=o[1];function m(){return(m=Object(p.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),i(!0),d("Google sign in failed");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function N(){return(N=Object(p.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),i(!0),d("Github sign in failed");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function y(){return(y=Object(p.a)(b.a.mark((function e(n){var a,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a=document.getElementById("email-input"),c=document.getElementById("password-input"),console.log("Email: "+a.value),console.log("Password: "+c.value),!0!==t){e.next=21;break}return s=document.getElementById("screen-name-input"),i(!1),e.prev=8,e.next=11,f(a.value,c.value);case 11:return e.next=13,O.ref("users").child(h().currentUser.uid).set(s.value);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(8),console.log(e.t0),d("Sign up failed");case 19:e.next=30;break;case 21:return e.prev=21,e.next=24,x(a.value,c.value);case 24:e.next=30;break;case 26:e.prev=26,e.t1=e.catch(21),i(!0),d("Login failed");case 30:case"end":return e.stop()}}),e,null,[[8,15],[21,26]])})))).apply(this,arguments)}return Object(C.jsx)("div",{className:"page--container",children:Object(C.jsxs)("div",{className:"page--wrapper",children:[Object(C.jsxs)("div",{className:"form--pane",children:[Object(C.jsx)("div",{className:"form--header-wrapper",children:Object(C.jsx)("h1",{className:"form--header",children:"The Lounge"})}),s?Object(C.jsx)(C.Fragment,{children:Object(C.jsx)("p",{className:"form--error",children:u})}):null,Object(C.jsxs)("form",{className:"form--style",onSubmit:function(e){return y.apply(this,arguments)},children:[Object(C.jsx)("input",{id:"email-input",className:"email--input-style",name:"email",type:"email",placeholder:"Email"}),Object(C.jsx)("input",{id:"password-input",height:"50px",className:t?"email--input-style":"password--input-style",name:"password",type:"password",placeholder:"Password"}),t?Object(C.jsx)("input",{id:"screen-name-input",height:"50px",className:"email--input-style",name:"name",type:"name",placeholder:"User Name"}):null,Object(C.jsx)("button",{className:"ripple",type:"submit",children:t?"Sign up":"Log in"})]})]}),Object(C.jsxs)("div",{className:"form--bottom-wrapper",children:[Object(C.jsx)("button",{onClick:function(){return m.apply(this,arguments)},className:"g ripple2",children:t?"Sign up with Google":"Log in with Google"}),Object(C.jsx)("button",{onClick:function(){return N.apply(this,arguments)},className:"f ripple3",children:t?"Sign Up with Github":"Log In with Github"})]}),Object(C.jsxs)("div",{className:"form--bottom-text-wrapper",children:[Object(C.jsxs)("p",{className:"form--bottom-text",children:[" ",t?"Already have an account?":"Don't have an account?"," "]}),Object(C.jsxs)(j.b,{className:"form--bottom-text-link",to:t?"/LogIn":"/SignUp",children:[" ",t?"Log in":"Sign up"," "]})]})]})})};var w=function(){return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(y,{isSignUp:!0})})};var S=function(){return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(y,{isSignUp:!1})})};n(98);var k=function(){return Object(C.jsx)("div",{className:"home--container",children:Object(C.jsxs)("div",{className:"home--wrapper",children:[Object(C.jsx)("div",{className:"header--wrapper",children:Object(C.jsx)("h1",{className:"header--style",children:" the Loungee "})}),Object(C.jsxs)("div",{className:"buttons--wrapper",children:[Object(C.jsx)(j.b,{to:"/LogIn",children:Object(C.jsx)("button",{class:"ripple",children:" Log In "})}),Object(C.jsx)(j.b,{to:"/SignUp",children:Object(C.jsx)("button",{class:"ripple",children:" Sign Up "})})]})]})})},I=(n(99),n(23));var E=function(){var e=Object(a.useState)(h().currentUser),t=Object(l.a)(e,2),n=t[0],c=(t[1],Object(a.useState)([])),s=Object(l.a)(c,2),i=s[0],r=s[1],o=Object(a.useState)(null),u=Object(l.a)(o,2),j=(u[0],u[1]),d=Object(a.useState)(n.email),m=Object(l.a)(d,2),f=m[0],x=m[1],g=Object(a.useState)(null),v=Object(l.a)(g,2),y=(v[0],v[1]),w=function(){var e=document.getElementById("scrollBox");e.scrollTop=e.scrollHeight};function S(){return(S=Object(p.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==(n=document.getElementById("message-input").value)){e.next=4;break}return e.abrupt("return");case 4:return y(null),e.prev=5,e.next=8,O.ref("chats").push({content:n,timestamp:Date.now(),sender:f});case 8:document.getElementById("message-input").value="",e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),y(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){j(null);try{O.ref("/users/"+n.uid).once("value").then((function(e){null!=e.val()&&x(e.val()),console.log("Username set to: "+f)})),O.ref("chats").on("value",(function(e){var t=[];e.forEach((function(e){t.push(e.val())})),r([].concat(t)),setTimeout(w,200)}))}catch(e){console.log(e),j(e.message)}}),[n.id,f]),Object(C.jsxs)("div",{className:"Chat--container",children:[Object(C.jsxs)("div",{className:"Chat--navbar",children:[Object(C.jsx)("h1",{className:"Chat--header",children:"the Lounge"}),Object(C.jsxs)("button",{onClick:N,style:{alignSelf:"flex-end",marginLeft:0,marginTop:0},className:"signout ripple",children:[" ",Object(C.jsx)(I.d,{size:30})]})]}),Object(C.jsx)("div",{id:"scrollBox",className:"Chat--wrapper",children:i.map((function(e,t){return console.log("Sender: "+e.sender+" content: "+e.content),Object(C.jsxs)("div",{style:{alignSelf:e.sender===f?"flex-end":"flex-start"},className:"Chat--message-wrapper",children:[Object(C.jsx)("div",{style:{display:"flex",justifyContent:e.sender===f?"flex-end":"flex-start"},children:Object(C.jsxs)("p",{style:{marginLeft:e.sender===f?0:7,marginRight:e.sender===f?7:0},className:"Chat--sender-name",children:[" ",e.sender," "]})}),Object(C.jsx)("div",{style:{justifyContent:e.sender===f?"flex-end":"flex-start"},className:"Chat--message-bubble",children:Object(C.jsx)("p",{className:"Chat--message",children:e.content},e.timestamp)})]})}))}),Object(C.jsx)("div",{className:"Chat--input-wrapper",children:Object(C.jsxs)("form",{onSubmit:function(e){return S.apply(this,arguments)},children:[Object(C.jsx)("input",{id:"message-input",className:"Chat--message-input",name:"message",type:"message",placeholder:"Aa"}),Object(C.jsx)("button",{className:"send-button ripple",children:Object(C.jsx)(I.b,{size:20,style:{marginRight:1}})})]})})]})},V=n(49),L=n.n(V);n(127);var B=function(){return Object(C.jsx)("div",{className:"CallMenu-container",children:Object(C.jsxs)("div",{className:"CallMenu-wrapper",children:[Object(C.jsxs)("div",{className:"CallMenu-button--wrapper",children:[Object(C.jsxs)(j.b,{to:"/VideoCall:host",className:"CallMenu-button",children:[" ",Object(C.jsx)(I.f,{color:"white",size:70})," "]}),Object(C.jsx)("label",{className:"CallMenu-button--label",children:"Host a call"})]}),Object(C.jsxs)("div",{className:"CallMenu-button--wrapper",children:[Object(C.jsxs)(j.b,{to:"/JoinCall",className:"CallMenu-button",children:[" ",Object(C.jsx)(I.e,{color:"white",size:70})," "]}),Object(C.jsx)("label",{className:"CallMenu-button--label",children:"Join a call"})]})]})})},M=(n(128),n(81)),P=n.n(M).a.connect("https://161.35.53.205:8000"),U=c.a.createContext();var J=function(){var e=Object(a.useContext)(U),t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],s=n[1];return Object(a.useEffect)((function(){e.on("no-matching-sess",(function(){console.log("No matching session found")})),e.on("matching-sess",(function(){s(!0)}))}),[]),c?(console.log("in sessFound, redirecting to VideoCall:guest"),Object(C.jsx)(u.a,{to:"/VideoCall:guest"})):Object(C.jsx)("div",{className:"JoinCall-container",children:Object(C.jsx)("div",{className:"JoinCall-wrapper",children:Object(C.jsxs)("div",{className:"JoinCall-form--wrapper",children:[Object(C.jsx)("h1",{className:"JoinCall-header",children:" Got a call key?"}),Object(C.jsxs)("form",{className:"JoinCall-form",onSubmit:function(t){t.preventDefault();var n=document.getElementById("key-input");e.emit("sessKey-submit",n.value),n.value=""},children:[Object(C.jsx)("input",{id:"key-input",className:"JoinCall-input",name:"key",type:"text",placeholder:"Enter key Here"}),Object(C.jsx)("button",{className:"ripple",children:" Join "})]})]})})})},A=n(82);n(144);var T=function(){var e=Object(a.useContext)(U),t=Object(u.g)().PeerType,n=":host"===t,c=Object(a.useState)([{name:"host",stream:null}]),s=Object(l.a)(c,2),i=s[0],r=s[1],o=Object(a.useState)(void 0),d=Object(l.a)(o,2),b=d[0],p=d[1],m=Object(a.useState)(void 0),h=Object(l.a)(m,2),O=h[0],f=h[1],x=Object(a.useState)(""),g=Object(l.a)(x,2),v=g[0],N=g[1],y=Object(a.useState)(!1),w=Object(l.a)(y,2),S=w[0],k=w[1],E=Object(a.useState)(!1),V=Object(l.a)(E,2),B=V[0],M=V[1],P=Object(a.useState)(!1),J=Object(l.a)(P,2),T=J[0],D=J[1];function G(a){p(a),console.log("in got media()");var c=new L.a({initiator:n,stream:a,trickle:!1});f(c),c.on("signal",(function(a){console.log(t),console.log(n),n?e.emit("host-signal",a):(console.log("firing geust-signal"),e.emit("guest-signal",a))})),document.getElementById("stream:0").srcObject=a,c.on("stream",(function(e){console.log("adding foreign stream"),document.getElementById("stream:1").srcObject=e})),e.on("signal-data",(function(e){console.log("in signal-data");r((function(e){return[].concat(Object(A.a)(e),[{name:"guest",stream:null}])}));try{c.signal(e),console.log("accepted the peers signal")}catch(t){console.log(t)}})),c.on("close",(function(){D(!0)}))}return Object(a.useEffect)((function(){console.log("In useeffect, peer: "+O),!n&&O&&(console.log("In useEffect, emitting get-host-data"),e.emit("get-host-data"))}),[O]),Object(a.useEffect)((function(){e.emit(":host"===t?"hosting-video-call":"joining-video-call"),e.on("session-key",(function(e){N(e),console.log("received sessKey: "+e)})),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(G).catch((function(){}))}),[]),Object(C.jsxs)("div",{className:"VideoCall-container",children:[T?Object(C.jsxs)("div",{className:"VideoCall-callEnded--wrapper",children:[Object(C.jsx)("h1",{style:{color:"white"},children:"Call ended"}),Object(C.jsx)(j.b,{to:"/CallMenu",className:"VideoCall-back--button ripple",children:"Back to Menu"})]}):Object(C.jsx)("div",{className:"VideoCall-wrapper",children:i.map((function(e,t){return Object(C.jsx)("div",{id:e.name,className:"VideoCall-stream--wrapper",children:Object(C.jsx)("video",{className:"VideoCall-stream--player",id:"stream:"+t,muted:t<1,autoPlay:!0,children:Object(C.jsx)("source",{src:e.stream,type:"video/mp4"})})})}))}),Object(C.jsxs)("div",{className:"VideoCall-bar",children:[Object(C.jsx)("h3",{className:"VideoCall-bar--key",children:""===v?"":"Session Key: "+v}),Object(C.jsxs)("div",{className:"VideoCall-bar--buttons-wrapper",children:[Object(C.jsx)("div",{className:"VideoCall-bar--button--wrapper",children:Object(C.jsx)("button",{onClick:function(){b.getAudioTracks()[0].enabled=S,k(!S)},className:"VideoCall-bar--button ripple",children:Object(C.jsx)(I.a,{size:30,color:S?"#242424":"#fff"})})}),Object(C.jsx)("div",{className:"VideoCall-bar--button--wrapper",children:Object(C.jsx)("button",{onClick:function(){O.destroy(),D(!0)},className:"VideoCall-bar--button ripple",children:Object(C.jsx)(I.c,{size:30,color:"#fff"})})}),Object(C.jsx)("div",{className:"VideoCall-bar--button--wrapper",children:Object(C.jsx)("button",{onClick:function(){b.getVideoTracks()[0].enabled=B,M(!B)},className:"VideoCall-bar--button ripple",children:Object(C.jsx)(I.f,{color:B?"#242424":"#fff",size:30})})})]})]})]})};function D(e){var t=e.component,n=e.authenticated,a=Object(o.a)(e,["component","authenticated"]);return Object(C.jsx)(u.b,Object(r.a)(Object(r.a)({},a),{},{render:function(e){return!0===n?Object(C.jsx)(t,Object(r.a)({},e)):Object(C.jsx)(u.a,{to:{pathname:"/LogIn",state:{from:e.location}}})}}))}function G(e){var t=e.component,n=e.authenticated,a=Object(o.a)(e,["component","authenticated"]);return Object(C.jsx)(u.b,Object(r.a)(Object(r.a)({},a),{},{render:function(e){return!1===n?Object(C.jsx)(t,Object(r.a)({},e)):Object(C.jsx)(u.a,{to:"/CallMenu"})}}))}var z=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(!0),i=Object(l.a)(s,2),r=(i[0],i[1]);return Object(a.useEffect)((function(){h().onAuthStateChanged((function(e){e?(c(!0),r(!1)):(c(!1),r(!0))}))}),[]),Object(C.jsx)(U.Provider,{value:P,children:Object(C.jsx)(j.a,{children:Object(C.jsxs)(u.d,{children:[Object(C.jsx)(u.b,{path:"/chat-app/",exact:!0,component:k}),Object(C.jsx)(G,{authenticated:n,path:"/LogIn",component:S}),Object(C.jsx)(G,{authenticated:n,path:"/SignUp",component:w}),Object(C.jsx)(D,{authenticated:n,path:"/Chat",component:E}),Object(C.jsx)(D,{authenticated:n,path:"/CallMenu",component:B}),Object(C.jsx)(D,{authenticated:n,path:"/JoinCall",component:J}),Object(C.jsx)(D,{authenticated:n,path:"/VideoCall:PeerType",component:T})]})})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,146)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};i.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(z,{})}),document.getElementById("root")),F()},87:function(e,t,n){},89:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[145,1,2]]]);
//# sourceMappingURL=main.b46220e4.chunk.js.map